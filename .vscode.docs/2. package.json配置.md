# package.json 配置列表
```js
{
	// 插件的名字，应全部小写，不能有空格
    "name": "diffvscode",
	// 插件的友好显示名称，用于显示在应用市场，支持中文
    "displayName": "diffVSCode",
	// 描述
    "description": "",
	// 关键字，用于应用市场搜索
    "keywords": ["vscode", "plugin", "diff"],
	// 版本号
    "version": "0.0.1",
	// 发布者，如果要发布到应用市场的话，这个名字必须与发布者一致
    "publisher": "rengarxiao",
	// 表示插件最低支持的vscode版本
    "engines": {
        "vscode": "^1.51.0"
    },
	// 插件应用市场分类，可选值： [Programming Languages, Snippets, Linters, Themes, Debuggers, Formatters, Keymaps, SCM Providers, Other, Extension Packs, Language Packs]
    "categories": [
        "Other"
    ],
	// 插件图标，至少128x128像素
    "icon": "images/icon.png",
	// 扩展的激活事件数组，可以被哪些事件激活扩展，TODO 后文有详细介绍
    "activationEvents": [
        // Ctrl+Shift+P 命令式
        "onCommand:diffvscode.sayHello"
    ],
	// 插件的主入口
    "main": "./src/extension",
	// 贡献点，整个插件最重要最多的配置项
    "contributes": {
		// Ctrl+Shift+P 命令式
        "commands": [
            {
                // 用户输入的命令
                "title": "Hello World",
                // 与之对应的注册命令
                "command": "diffvscode.sayHello"
            }
        ],
		// 快捷键绑定
        "keybindings": [
            {
                "command": "diffvscode.sayHello",
                "key": "ctrl+f10",
                "mac": "cmd+f10",
                // 快捷键生效前提，可选值：[editorFocus, editorTextFocus, resourceLangId == javascript]
                "when": "editorTextFocus"
            }
        ],
		// 菜单
        "menus": {
			// 编辑器右键展示菜单
            "editor/context": [
                {
					// 表示只有编辑器具有焦点时才会在菜单中出现
                    "when": "editorFocus",
                    "command": "diffvscode.sayHello",
                    // navigation是一个永远【置顶】的分组
                    // z_commands是一个【置底】的分组
                    // @6是人工添加的命令 进行组内排序，不影响默认命令
                    "group": "navigation@6"
                },
                {
                    "when": "editorFocus",
                    "command": "diffvscode.demo.getCurrentFilePath",
                    "group": "navigation@5"
                },
                {
					// 只有编辑器具有焦点，并且打开的是JS文件才会出现
                    "when": "editorFocus && resourceLangId == javascript",
                    "command": "diffvscode.demo.testMenuShow",
                    "group": "z_commands"
                },
                {
                    "command": "diffvscode.demo.openWebview",
                    "group": "navigation"
                }
            ],
			// 编辑器右上角图标，不配置图片就显示文字
            "editor/title": [
                {
                    "when": "editorFocus && resourceLangId == javascript",
                    "command": "diffvscode.demo.testMenuShow",
                    "group": "navigation"
                }
            ],
			// 编辑器标题右键菜单
            "editor/title/context": [
                {
                    "when": "resourceLangId == javascript",
                    "command": "diffvscode.demo.testMenuShow",
                    "group": "navigation"
                }
            ],
			// 资源管理器右键菜单
            "explorer/context": [
                {
                    "command": "diffvscode.demo.getCurrentFilePath",
                    "group": "navigation"
                },
                {
                    "command": "diffvscode.demo.openWebview",
                    "group": "navigation"
                }
            ]
        },
		// 插件配置项
		"configuration": {
            "type": "object",
			// 配置项标题，会显示在vscode的设置页
            "title": "vscode-plugin-demo",
            "properties": {
				// 这里我随便写了2个设置，配置你的昵称
                "vscodePluginDemo.yourName": {
                    "type": "string",
                    "default": "guest",
                    "description": "你的名字"
                },
				// 是否在启动时显示提示
                "vscodePluginDemo.showTip": {
                    "type": "boolean",
                    "default": true,
                    "description": "是否在每次启动时显示欢迎提示！"
                }
            }
        },
		// 代码片段
        "snippets": [
            {
                "language": "javascript",
                "path": "./snippets/javascript.json"
            },
            {
                "language": "html",
                "path": "./snippets/html.json"
            }
        ],
		// 自定义新的activitybar图标，也就是左侧侧边栏大的图标
        "viewsContainers": {
            "activitybar": [
                {
                    "id": "beautifulGirl",
                    "title": "美女",
                    "icon": "images/beautifulGirl.svg"
                }
            ]
        },
		// 自定义侧边栏内view的实现
        "views": {
			// 和 viewsContainers 的id对应
            "beautifulGirl": [
                {
                    "id": "beautifulGirl1",
                    "name": "国内美女"
                },
                {
                    "id": "beautifulGirl2",
                    "name": "国外美女"
                },
                {
                    "id": "beautifulGirl3",
                    "name": "人妖"
                }
            ]
        },
		// 图标主题
        "iconThemes": [
            {
                "id": "testIconTheme",
                "label": "测试图标主题",
                "path": "./theme/icon-theme.json"
            }
        ]
    },
	// 同 npm scripts
    "scripts": {
        "postinstall": "node ./node_modules/vscode/bin/install",
        "test": "node ./node_modules/vscode/bin/test"
    },
	// 开发依赖
    "devDependencies": {
        "typescript": "^2.6.1",
        "vscode": "^1.1.6",
        "eslint": "^4.11.0",
        "@types/node": "^7.0.43",
        "@types/mocha": "^2.2.42"
    },
	// 后面这几个应该不用介绍了
    "license": "SEE LICENSE IN LICENSE.txt",
    "bugs": {
        "url": "https://github.com/sxei/vscode-plugin-demo/issues"
    },
    "repository": {
        "type": "git",
        "url": "https://github.com/sxei/vscode-plugin-demo"
    },
	// 主页
    "homepage": "https://github.com/sxei/vscode-plugin-demo/blob/master/README.md"
}
```

<style>
    .text__remind {
        background-color: #f8f8f8;
        color: #e96900;
    }
</style>

## activationEvents
**插件在VS Code中默认是不会激活的，activationEvents用于定义插件何时被加载/激活**。目前支持以下激活事件：
```JS
{
    "activationEvents": [
        "onCommand:diffvscode.sayHello"
    ],
}
```
- onLanguage:${language} 打开特定语言文件时
- onCommand:${command} 调用某个 VSCode命令时
- workspaceContains:${toplevelfilename} 当打开包含某个命令规则的文件夹时
- onFileSystem:${scheme} 以某个协议（ftp/sftp/ssh等）打开文件或文件夹时
- onView:${viewId} 指定 id 的视图展开时
- onUri 插件的系统级 URI 打开时
- onWebviewPanel webview 触发时
- \* 启动VS Code就激活插件，性能考虑，【不推荐】

> PS：出于性能考虑，插件都是懒加载的，只有特定场景下才会加载/激活，才会消耗内存等资源。

## contributes
用于定义扩展项的具体配置。**通常完成命令的开发后，会将其与菜单/快捷键进行关联，以便调用。**

- <span class="text__remind">configuration</span>
  暴露给用户的 "设置选项"，可以再 用户设置 和 工作区设置 修改暴露的选项
  > 可以用vscode.workspace.getConfiguration('myExtension')读取用户配置值
  ```js
  "contributes": {
    "configuration": {
        "type": "object",
        "title": "TypeScript configuration",
        "properties": {
            "typescript.useCodeSnippetsOnMethodSuggest": {
                "type": "boolean",
                "default": false,
                "description": "Complete functions with their parameter signature."
            },
            "typescript.tsdk": {
                "type": ["string", "null"],
                "default": null,
                "description": "Specifies the folder path containing the tsserver and lib*.d.ts files to use."
            }
        }
    }
  }
  ```
 <img src="https://rengar-1253859411.cos.ap-chengdu.myqcloud.com/img/20201111200229.png" width = "400" height = "400" alt="图片名称" style="margin: 0 auto;display: block;" />

- <span class="text__remind">configurationDefaults</span>
  覆盖特定语言的编辑器配置，如修改 js代码格式化规则等...
  ```js
  "contributes": {
    "configurationDefaults": {
        "[markdown]": {
            "editor.wordWrap": "on",
            "editor.quickSuggestions": false
        }
    }
  }
  ```

- <span class="text__remind">commands</span>
  **设置将会用到的 命令**(这里相当于注册命令)，随后命令会出现在 **命令面板** 中的命令。可以加上 category 前缀，在命令面板中分类展示。
  > 通过 Ctrl+Shift+P 打开命令面板
  ```js
  "contributes": {
    "commands": [{
        "command": "extension.sayHello",
        "title": "Hello World",
        "category": "Hello"
    }]
  }
  ```
 <img src="https://rengar-1253859411.cos.ap-chengdu.myqcloud.com/img/20201111200723.png" width = "500" height = "450" alt="图片名称" style="margin: 0 auto;display: block;" />
 
- <span class="text__remind">menus</span>
  配置菜单项，菜单的配置内容至少包含：1. command指定选中菜单项时调用什么命令；2. [when](https://github.com/Microsoft/vscode-docs/blob/master/docs/getstarted/keybindings.md#when-clause-contexts)指定菜单项出现的时机。
  可选值alt指定 可选命令；可选值group指定 自定义菜单命令的排序。

  > 以下是菜单的种类
  - commandPalette 在commands中的命令默认会出现在命令面板中，这里可以控制命令是否能出现在命令面板中，**建议和命令的其他行为保持一致**
    ```js
    "commands": [{
        "command": "extension.sayHello",
        "title": "Hello World"
    }],
    "menus": {
        "commandPalette": [{
            "command": "extension.sayHello",
            "when": "editorHasSelection"
        }]
    }
    ```
  - explorer/context 资源管理器上下文菜单
  - editor/context 编辑器上下文菜单
  ```js
  "contributes": {
    "menus": {
        "editor/context": [{
            "when": "resourceLangId == markdown",
            "command": "markdown.showPreview",
            "alt": "markdown.showPreviewToSide",
            "group": "navigation"
        }]
    }
  }
  ```
  - editor/title 编辑器标题栏
  - editor/title/context 编辑器标题上下文菜单
  - debug/callstack/context 调试栈视图的上下文菜单
  - scm/title SCM标题菜单
  - scm/resourceGroup/context SCM资源组
  - scm/resource/context SCM资源
  - scm/change/title SCM改变标题
  - view/title 视图的标题菜单
  - view/item/context 视图项的菜单

- <span class="text__remind">keybindings</span>
  定义用户在按下某个按键组合的时候触发的命令
  > 因为VSCode支持Windows、Linux(key)和macOS(mac)平台，需要区分设置
  ```js
  "contributes": {
    "keybindings": [{
        "command": "extension.sayHello",
        "key": "ctrl+f1",
        "mac": "cmd+f1",
        "when": "editorTextFocus"
    }]
  }
  ```

- <span class="text__remind">views</span>
  在 左侧的资源管理器(explorer)中添加视图
  ```js
  "contributes": {
    "views": {
        "explorer": [
            {
                "id": "nodeDependencies",
                "name": "Node Dependencies",
                "when": "workspaceHasPackageJSON"
            }
        ]
    }
  }
  ```
 <img src="https://rengar-1253859411.cos.ap-chengdu.myqcloud.com/img/20201112104021.png" width = "300" height = "650" alt="图片名称" style="margin: 0 auto;display: block;" />

- <span class="text__remind">viewsContainers</span>
  为左侧的视图自定义视图容器
 <img src="https://rengar-1253859411.cos.ap-chengdu.myqcloud.com/img/20201112104213.png" width = "400" height = "500" alt="图片名称" style="margin: 0 auto;display: block;" />

- languages：新语言支持
- debuggers：调试
- breakpoints：断点
- grammars
- themes：主题
- snippets：代码片段
- jsonValidation：自定义JSON校验
- problemMatchers
- problemPatterns
- taskDefinitions
- colors


### 编辑器命令面板的组间排序
编辑器上下文菜单可以通过 group 属性进行 组间排序
- navigation 始终位于最上方
- 1_modification 紧接着上一组，这个组包含可以修改代码的命令
- 9_cutcopypaste 基础编辑命令
- z_commands 最后一个分组，命令面板入口
<img src="https://rengar-1253859411.cos.ap-chengdu.myqcloud.com/img/20201112100956.png" width = "600" height = "250" alt="图片名称" style="margin: 0 auto;display: block;" />
> 资源管理器上下文菜单有下列分组
- navigation 在VS Code中导航的相关命令。navigation组始终在最上方。
- 2_workspace 和工作区操作相关的命令。
- 3_compare 比较文件和diff相关的命令。
- 4_search 在搜索视图中和搜索相关的命令。
- 5_cutcopypaste 和剪切、复制、粘贴文件相关的命令。
- 7_modification 修改文件的相关命令
> 编辑器标签菜单有下列分组
- 1_close 和关闭编辑器相关命令
- 3_preview 和固定编辑器相关命令
> 编辑器标题菜单有下列分组
- 1_diff diff编辑器相关的命令
- 3_open 打开编辑器的相关命令
- 5_close 关闭编辑器相关的命令

### 编辑器命令面板的组内排序
可以通过指定 @<number> 来定义顺序
```js
"editor/title": [{
    "when": "editorHasSelection",
    "command": "extension.Command",
    "group": "myGroup@1"
}]
```